---
layout: default
title: GCP App Engine 扣费问题
color: 03A9F4
author: onoicq
description: 为什么 1 个 instance 每天会运行 57 小时？
---  

我在 GCP 上写了个小应用，由于是自己用的，所以打算就只用 App Engine 免费配额，并限制了 instance 个数。  
文档中提到 F1 类型可每天使用28小时，因此配置最大个数为 1。服务器会根据访问情况决定 instance 个数，由于大部分时间属于闲置，服务器就自动调整为 0 相当于休眠或者关机了。  
之后发现访问时启动时间较长，大约需要 5-8 秒，体验较差，所以又配置了 warmup 和至少 1 个 instance 运行，反正也不会超。首次访问等待的问题解决了。  
但是看账单发现一天内使用时长达到了 57 小时，扣了一美元，差点因此放弃 GCP。  
经过调查发现：每次版本更新，旧版本仍可运行，但是流量会指向最新版本，估计是一旦出现崩溃，服务器会将流量导向上一个。所以造成了使用时长超出免费配额。
果断删除前11个版本迭代。  
